<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AI Story Tailor v7.7.1 - Beauty & Power</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    /* ‡πÉ‡∏ä‡πâ Gradient ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏£‡∏∏‡πà‡∏ô 70B */
    body {
      font-family: 'Sarabun', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px 0;
    }
    .main-card {
      border-radius: 20px;
      border: none;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      background: white;
      overflow: hidden;
    }
    .card-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
      border-bottom: none;
    }
    .card-header h2 { font-weight: 600; margin-bottom: 5px; }
    
    .api-management {
      background: #f8f9fa;
      padding: 20px;
      border-bottom: 1px solid #eee;
    }
    .key-input {
      border-radius: 8px;
      border: 1px solid #ddd;
      transition: all 0.3s;
    }
    .key-input:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 0.25rem rgba(102, 126, 234, 0.25);
    }

    .story-display {
      line-height: 2.4;
      font-size: 1.25rem;
      color: #333;
      padding: 30px;
      background: #ffffff;
      border-radius: 15px;
      margin-top: 20px;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.02);
    }
    
    .word-clickable {
      cursor: pointer;
      border-bottom: 2px dotted #667eea;
      transition: all 0.2s;
      color: #2d3748;
    }
    .word-clickable:hover {
      background-color: rgba(102, 126, 234, 0.1);
      color: #667eea;
      border-radius: 4px;
    }

    .tooltip-box {
      position: absolute;
      background: #1e293b;
      color: white;
      padding: 12px 18px;
      border-radius: 10px;
      font-size: 1rem;
      z-index: 10000;
      display: none;
      pointer-events: none;
      box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    }

    .btn-generate {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      color: white;
      font-weight: 600;
      padding: 15px;
      border-radius: 12px;
      transition: transform 0.2s;
    }
    .btn-generate:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      color: white;
    }
    
    #loading { display: none; }
  </style>
</head>
<body>

<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <div class="card main-card">
        <div class="card-header">
          <h2>‚ú® AI Story Tailor v7.7.1</h2>
          <p class="mb-0 opacity-75">Premium Look | Multi-Key Support | High Speed 8B</p>
        </div>
        
        <div class="api-management">
          <div class="row g-2">
            <div class="col-md-4"><input type="password" id="k1" class="form-control form-control-sm key-input" placeholder="üîë API Key 1"></div>
            <div class="col-md-4"><input type="password" id="k2" class="form-control form-control-sm key-input" placeholder="üîë API Key 2"></div>
            <div class="col-md-4"><input type="password" id="k3" class="form-control form-control-sm key-input" placeholder="üîë API Key 3"></div>
            <div class="col-md-6"><input type="password" id="k4" class="form-control form-control-sm key-input" placeholder="üîë API Key 4"></div>
            <div class="col-md-6"><input type="password" id="k5" class="form-control form-control-sm key-input" placeholder="üîë API Key 5"></div>
          </div>
          <div class="mt-3 d-flex justify-content-between">
            <small class="text-muted">‡πÉ‡∏™‡πà Key ‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 50 ‡∏Ñ‡∏ô</small>
            <div>
              <button class="btn btn-dark btn-sm shadow-sm" onclick="saveKeys()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Keys</button>
              <button class="btn btn-outline-danger btn-sm" onclick="secureClear()">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </div>
          </div>
        </div>

        <div class="card-body p-4">
          <div class="mb-4">
            <label class="form-label fw-bold">üìù ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label>
            <input type="text" id="topic" class="form-control form-control-lg shadow-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏ú‡∏à‡∏ç‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏á‡∏Å‡∏£‡∏ï‡∏±‡∏ß‡∏ô‡πâ‡∏≠‡∏¢">
          </div>
          
          <button onclick="generate()" id="genBtn" class="btn btn-generate w-100 shadow">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏ï‡πà‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©</button>

          <div id="loading" class="text-center my-5">
            <div class="spinner-border text-primary" style="width: 3.5rem; height: 3.5rem;"></div>
            <p class="mt-3 fw-bold text-secondary">AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Key ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á...</p>
          </div>

          <div id="storyOut" class="story-display mt-4 shadow-sm" style="display:none;"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="tbox" class="tooltip-box"></div>

<script>
  window.onload = () => {
    for(let i=1; i<=5; i++) document.getElementById('k'+i).value = localStorage.getItem('gk'+i) || '';
  };

  function saveKeys() {
    for(let i=1; i<=5; i++) localStorage.setItem('gk'+i, document.getElementById('k'+i).value.trim());
    alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏à‡∏≥ Key ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ');
  }

  function secureClear() {
    const pw = prompt("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏≤‡∏á Key:");
    if(pw === "pass3") {
        for(let i=1; i<=5; i++) {
            document.getElementById('k'+i).value = '';
            localStorage.removeItem('gk'+i);
        }
        alert('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß');
    } else { alert('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'); }
  }

  async function generate() {
    let keys = [];
    for(let i=1; i<=5; i++) {
        let v = document.getElementById('k'+i).value.trim();
        if(v.startsWith('gsk_')) keys.push(v);
    }
    
    if(keys.length === 0) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà API Key ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏ä‡πà‡∏≠‡∏á');
    const topic = document.getElementById('topic').value;
    if(!topic) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á');

    const skey = keys[Math.floor(Math.random() * keys.length)];
    const btn = document.getElementById('genBtn');
    const load = document.getElementById('loading');
    const out = document.getElementById('storyOut');

    btn.disabled = true;
    load.style.display = 'block';
    out.style.display = 'none';

    try {
      const res = await fetch('https://api.groq.com/openai/v1/chat/completions', {
        method: 'POST',
        headers: { 'Authorization': `Bearer ${skey}`, 'Content-Type': 'application/json' },
        body: JSON.stringify({
          model: "llama-3.1-8b-instant",
          messages: [{
            role: "user", 
            content: `Write a short story about "${topic}" in English (Elementary Level). Use 3 paragraphs. Only output the story text.`
          }],
          temperature: 0.7
        })
      });

      const data = await res.json();
      if(data.error) throw new Error(data.error.message);
      
      renderContent(data.choices[0].message.content);
      out.style.display = 'block';
      out.scrollIntoView({ behavior: 'smooth' });
    } catch(err) {
      alert("Error: " + err.message);
    } finally {
      btn.disabled = false;
      load.style.display = 'none';
    }
  }

  function renderContent(txt) {
    const out = document.getElementById('storyOut');
    out.innerHTML = '';
    const paragraphs = txt.split('\n\n');
    
    paragraphs.forEach(pTxt => {
      const p = document.createElement('p');
      const words = pTxt.split(/(\s+)/);
      words.forEach(w => {
        if(/[a-zA-Z]/.test(w)) {
          const span = document.createElement('span');
          span.className = 'word-clickable';
          span.textContent = w;
          span.onmouseover = (e) => showTrans(e, w);
          span.onmouseout = () => document.getElementById('tbox').style.display='none';
          span.onclick = () => {
            const ut = new SpeechSynthesisUtterance(w.replace(/[^\w]/g,''));
            ut.lang = 'en-US';
            speechSynthesis.speak(ut);
          };
          p.appendChild(span);
        } else {
          p.appendChild(document.createTextNode(w));
        }
      });
      out.appendChild(p);
    });
  }

  async function showTrans(e, w) {
    const cleanWord = w.replace(/[.,!?;:"]/g, '');
    const tb = document.getElementById('tbox');
    tb.style.display = 'block';
    tb.style.left = (e.pageX + 10) + 'px';
    tb.style.top = (e.pageY + 10) + 'px';
    tb.innerHTML = '...';

    try {
      const r = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=th&dt=t&q=${cleanWord}`);
      const d = await r.json();
      tb.innerHTML = `<strong>${cleanWord}</strong><br><span style="color:#fbbf24">‡πÅ‡∏õ‡∏•: ${d[0][0][0]}</span>`;
    } catch {
      tb.innerHTML = cleanWord;
    }
  }
</script>
</body>
</html>
